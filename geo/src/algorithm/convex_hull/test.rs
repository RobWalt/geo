use super::*;
use crate::geometry::*;
use crate::{coord, line_string, polygon};

#[test]
fn test_zero_points() {
    let mut v: Vec<Coordinate<i64>> = vec![];
    let correct = vec![];
    let res = trivial_hull(&mut v, false);
    assert_eq!(res.0, correct);
}

#[test]
fn test_zero_points_include_on_hull() {
    let mut v: Vec<Coordinate<i64>> = vec![];
    let correct = vec![];
    let res = trivial_hull(&mut v, true);
    assert_eq!(res.0, correct);
}

#[test]
fn test_one_point() {
    let mut v = vec![coord! { x: 0, y: 0 }];
    let correct = vec![coord! { x: 0, y: 0 }, coord! { x: 0, y: 0 }];
    let res = trivial_hull(&mut v, false);
    assert_eq!(res.0, correct);
}

#[test]
fn test_one_point_include_on_hull() {
    let mut v = vec![coord! { x: 0, y: 0 }];
    let correct = vec![coord! { x: 0, y: 0 }, coord! { x: 0, y: 0 }];
    let res = trivial_hull(&mut v, true);
    assert_eq!(res.0, correct);
}

#[test]
fn test_two_points() {
    let mut v = vec![coord! { x: 0, y: 0 }, coord! { x: 1, y: 1 }];
    let correct = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 1, y: 1 },
        coord! { x: 0, y: 0 },
    ];
    let res = trivial_hull(&mut v, false);
    assert_eq!(res.0, correct);
}

#[test]
fn test_two_points_include_on_hull() {
    let mut v = vec![coord! { x: 0, y: 0 }, coord! { x: 1, y: 1 }];
    let correct = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 1, y: 1 },
        coord! { x: 0, y: 0 },
    ];
    let res = trivial_hull(&mut v, true);
    assert_eq!(res.0, correct);
}

#[test]
fn test_two_points_duplicated() {
    let mut v = vec![coord! { x: 0, y: 0 }, coord! { x: 0, y: 0 }];
    let correct = vec![coord! { x: 0, y: 0 }, coord! { x: 0, y: 0 }];
    let res = trivial_hull(&mut v, false);
    assert_eq!(res.0, correct);
}

#[test]
fn test_two_points_duplicated_include_on_hull() {
    let mut v = vec![coord! { x: 0, y: 0 }, coord! { x: 0, y: 0 }];
    let correct = vec![coord! { x: 0, y: 0 }, coord! { x: 0, y: 0 }];
    let res = trivial_hull(&mut v, true);
    assert_eq!(res.0, correct);
}

#[test]
fn test_three_points_ccw() {
    let mut v = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 1, y: 0 },
        coord! { x: 1, y: 1 },
    ];
    let correct = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 1, y: 0 },
        coord! { x: 1, y: 1 },
        coord! { x: 0, y: 0 },
    ];
    let res = trivial_hull(&mut v, false);
    assert_eq!(res.0, correct);
}

#[test]
fn test_three_points_cw() {
    let mut v = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 1, y: 1 },
        coord! { x: 1, y: 0 },
    ];
    let correct = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 1, y: 0 },
        coord! { x: 1, y: 1 },
        coord! { x: 0, y: 0 },
    ];
    let res = trivial_hull(&mut v, false);
    assert_eq!(res.0, correct);
}

#[test]
fn test_three_points_two_duplicated() {
    let mut v = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 1, y: 1 },
        coord! { x: 0, y: 0 },
    ];
    let correct = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 1, y: 1 },
        coord! { x: 0, y: 0 },
    ];
    let res = trivial_hull(&mut v, false);
    assert_eq!(res.0, correct);
}

#[test]
fn test_three_points_two_duplicated_include_on_hull() {
    let mut v = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 1, y: 1 },
        coord! { x: 0, y: 0 },
    ];
    let correct = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 1, y: 1 },
        coord! { x: 0, y: 0 },
    ];
    let res = trivial_hull(&mut v, true);
    assert_eq!(res.0, correct);
}

#[test]
fn test_three_points_duplicated() {
    let mut v = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 0, y: 0 },
        coord! { x: 0, y: 0 },
    ];
    let correct = vec![coord! { x: 0, y: 0 }, coord! { x: 0, y: 0 }];
    let res = trivial_hull(&mut v, false);
    assert_eq!(res.0, correct);
}

#[test]
fn test_three_points_duplicated_include_on_hull() {
    let mut v = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 0, y: 0 },
        coord! { x: 0, y: 0 },
    ];
    let correct = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 0, y: 0 },
        coord! { x: 0, y: 0 },
    ];
    let res = trivial_hull(&mut v, true);
    assert_eq!(res.0, correct);
}

#[test]
fn test_three_collinear_points() {
    let mut v = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 1, y: 1 },
        coord! { x: 2, y: 2 },
    ];
    let correct = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 2, y: 2 },
        coord! { x: 0, y: 0 },
    ];
    let res = trivial_hull(&mut v, false);
    assert_eq!(res.0, correct);
}

#[test]
fn test_three_collinear_points_include_on_hull() {
    let mut v = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 1, y: 1 },
        coord! { x: 2, y: 2 },
    ];
    let correct = vec![
        coord! { x: 0, y: 0 },
        coord! { x: 1, y: 1 },
        coord! { x: 2, y: 2 },
        coord! { x: 0, y: 0 },
    ];
    let res = trivial_hull(&mut v, true);
    assert_eq!(res.0, correct);
}

#[test]
fn convex_hull_multipoint_test() {
    let v = vec![
        Point::new(0, 10),
        Point::new(1, 1),
        Point::new(10, 0),
        Point::new(1, -1),
        Point::new(0, -10),
        Point::new(-1, -1),
        Point::new(-10, 0),
        Point::new(-1, 1),
        Point::new(0, 10),
    ];
    let mp = MultiPoint::new(v);
    let correct = vec![
        Coordinate::from((0, -10)),
        Coordinate::from((10, 0)),
        Coordinate::from((0, 10)),
        Coordinate::from((-10, 0)),
        Coordinate::from((0, -10)),
    ];
    let res = mp.convex_hull();
    assert_eq!(res.exterior().0, correct);
}
#[test]
fn convex_hull_linestring_test() {
    let mp = line_string![
        (x: 0.0, y: 10.0),
        (x: 1.0, y: 1.0),
        (x: 10.0, y: 0.0),
        (x: 1.0, y: -1.0),
        (x: 0.0, y: -10.0),
        (x: -1.0, y: -1.0),
        (x: -10.0, y: 0.0),
        (x: -1.0, y: 1.0),
        (x: 0.0, y: 10.0),
    ];
    let correct = vec![
        Coordinate::from((0.0, -10.0)),
        Coordinate::from((10.0, 0.0)),
        Coordinate::from((0.0, 10.0)),
        Coordinate::from((-10.0, 0.0)),
        Coordinate::from((0.0, -10.0)),
    ];
    let res = mp.convex_hull();
    assert_eq!(res.exterior().0, correct);
}
#[test]
fn convex_hull_multilinestring_test() {
    let v1 = line_string![(x: 0.0, y: 0.0), (x: 1.0, y: 10.0)];
    let v2 = line_string![(x: 1.0, y: 10.0), (x: 2.0, y: 0.0), (x: 3.0, y: 1.0)];
    let mls = MultiLineString::new(vec![v1, v2]);
    let correct = vec![
        Coordinate::from((2.0, 0.0)),
        Coordinate::from((3.0, 1.0)),
        Coordinate::from((1.0, 10.0)),
        Coordinate::from((0.0, 0.0)),
        Coordinate::from((2.0, 0.0)),
    ];
    let res = mls.convex_hull();
    assert_eq!(res.exterior().0, correct);
}
#[test]
fn convex_hull_multipolygon_test() {
    let p1 = polygon![(x: 0.0, y: 0.0), (x: 1.0, y: 10.0), (x: 2.0, y: 0.0), (x: 0.0, y: 0.0)];
    let p2 = polygon![(x: 3.0, y: 0.0), (x: 4.0, y: 10.0), (x: 5.0, y: 0.0), (x: 3.0, y: 0.0)];
    let mp = MultiPolygon::new(vec![p1, p2]);
    let correct = vec![
        Coordinate::from((5.0, 0.0)),
        Coordinate::from((4.0, 10.0)),
        Coordinate::from((1.0, 10.0)),
        Coordinate::from((0.0, 0.0)),
        Coordinate::from((5.0, 0.0)),
    ];
    let res = mp.convex_hull();
    assert_eq!(res.exterior().0, correct);
}

#[test]
fn collection() {
    let collection = GeometryCollection(vec![
        Point::new(0.0, 0.0).into(),
        Triangle::new(
            coord! { x: 1.0, y: 0.0},
            coord! { x: 4.0, y: 0.0},
            coord! { x: 4.0, y: 4.0 },
        )
        .into(),
    ]);

    let convex_hull = collection.convex_hull();
    assert_eq!(
        convex_hull,
        polygon![
            coord! { x: 4.0, y: 0.0 },
            coord! { x: 4.0, y: 4.0 },
            coord! { x: 0.0, y: 0.0 }
        ]
    );
}

#[test]
fn convex_hull_broken() {
    let points = vec![
        Point::new(-82.44084200005813, 38.4154049997411),
        Point::new(-97.93006099981511, 38.055858999993006),
        Point::new(-94.42929799950292, 39.086975000296206),
        Point::new(-86.16030900006018, 39.762154000007286),
        Point::new(-117.75919299965705, 33.67476700029698),
        Point::new(-90.19059800029731, 32.3006439994212),
        Point::new(-81.72460200078154, 30.36657699972892),
        Point::new(-92.17038000013673, 38.57905200014983),
        Point::new(-88.07914000041052, 41.52487600042724),
        Point::new(-81.88220199932266, 31.605908999900578),
        Point::new(-78.92242400036719, 40.33010100006129),
        Point::new(-84.40029100022934, 42.24805100025361),
        Point::new(-85.58358800008597, 42.29545199991003),
        Point::new(-80.62181099927807, 35.50126600012595),
        Point::new(-94.58394600040742, 39.08615100006875),
        Point::new(-89.92742199932565, 41.24562500009387),
        Point::new(-122.91176600010067, 46.14262399939821),
        Point::new(-121.7709200000578, 42.22587999946256),
        Point::new(-71.56228599989885, 41.483940000330904),
        Point::new(-81.40512176945396, 28.293432494114484),
        Point::new(-87.86576099987008, 41.11913299988822),
        Point::new(-114.05207099967674, 35.18835799992195),
        Point::new(-119.55650299971353, 36.0981940002531),
        Point::new(-85.13355999969406, 39.6464649997601),
        Point::new(-75.8206629999973, 39.98561899981718),
        Point::new(-79.59259800039723, 40.018100999461694),
        Point::new(-120.9527049998357, 39.099456999441145),
        Point::new(-119.5213170003791, 34.39600399978491),
        Point::new(-86.89938400017132, 40.04425400042197),
        Point::new(-94.36119800038728, 41.05708300008058),
        Point::new(-73.88384200010807, 41.19272999978983),
        Point::new(-89.88891599977342, 39.279327000640706),
        Point::new(-82.83348100064751, 34.69117700051834),
        Point::new(-86.5690309994809, 30.757586999840328),
        Point::new(-122.95188099920858, 46.71742199972567),
        Point::new(-78.75847599956757, 39.65058499999793),
        Point::new(-112.33002499995365, 48.63693999938164),
        Point::new(-78.49211099992255, 38.032031999277535),
        Point::new(-74.95143107618304, 40.07172972065024),
        Point::new(-118.59873200028142, 34.25711799999584),
        Point::new(-78.77967800063908, 35.7877080002242),
        Point::new(-96.80740400039417, 32.77554299921019),
        Point::new(-79.38431500013701, 36.58369799986298),
        Point::new(-121.73706800018789, 38.544113000514756),
        Point::new(-100.01657899982081, 37.75259799949822),
        Point::new(-107.76083399998896, 32.27108400052634),
        Point::new(-104.99961100054708, 39.7532230000416),
        Point::new(-83.20118000045653, 42.31304900021138),
        Point::new(-83.07209800042222, 42.36788199995448),
        Point::new(-80.12146000027866, 26.317794999239993),
        Point::new(-70.93582944477288, 43.138976239162275),
        Point::new(-79.37175799933203, 34.418284999353375),
        Point::new(-80.09252899981334, 26.455179000810404),
        Point::new(-81.35245499999809, 29.016833999889343),
        Point::new(-95.84558100026283, 46.81948899951789),
        Point::new(-78.90722700012583, 35.99703600011151),
        Point::new(-81.14315000027216, 33.326144999792064),
        Point::new(-86.10873400037366, 41.981201000725775),
        Point::new(-70.87664799990512, 43.198656000174424),
        Point::new(-75.70812199923074, 40.00253700028253),
        Point::new(-89.24015799989161, 38.01135299984122),
        Point::new(-83.98243700056696, 42.90977900020084),
        Point::new(-100.90146599985587, 29.363080999688577),
        Point::new(-122.26997400039966, 41.21117399958058),
        Point::new(-98.8613739995103, 48.11064500006688),
        Point::new(-88.42832200065965, 41.09204900006148),
        Point::new(-87.51818799917669, 41.498528000367116),
        Point::new(-122.38307199987275, 47.811295000064376),
        Point::new(-88.54571499944751, 39.11915600044921),
        Point::new(-85.9710540004416, 41.68072099987444),
        Point::new(-115.75339499977929, 40.836875999428),
        Point::new(-106.494888000081, 31.757725000608445),
        Point::new(-76.61457800017439, 40.147400000509776),
        Point::new(-82.09700800001906, 41.37005199950033),
        Point::new(-122.29068000018174, 37.840679000036005),
        Point::new(-119.5486449997668, 47.32059500005937),
        Point::new(-80.08103900054931, 42.12112799995742),
        Point::new(-113.60948199969437, 48.28086100033505),
        Point::new(-73.11045099941396, 44.49257299944452),
        Point::new(-123.09184300005427, 44.05538599946448),
        Point::new(-122.21562200035487, 47.979282000064416),
        Point::new(-74.19059638651385, 40.705134086269254),
        Point::new(-70.95782200028492, 42.981603000178495),
        Point::new(-75.62202053511947, 40.01910902616078),
        Point::new(-96.7846149998822, 46.88107700050335),
        Point::new(-78.8850630005569, 35.05490499976611),
        Point::new(-77.45693200021151, 38.2985570000057),
        Point::new(-73.58046000032857, 43.26951599976377),
        Point::new(-73.26204699986897, 43.590575999982605),
        Point::new(-111.65066499988967, 35.19801300000012),
        Point::new(-83.65483900011964, 43.0136339997095),
        Point::new(-79.75709499953444, 34.1988180004505),
        Point::new(-91.33335899961799, 40.62339400043294),
        Point::new(-103.80265000009729, 40.24732999977982),
        Point::new(-122.00637799984469, 37.55819699999171),
        Point::new(-119.78224899949157, 36.73862799938286),
        Point::new(-71.41786199923172, 42.2766689997747),
        Point::new(-77.17054700004388, 38.76501800008083),
        Point::new(-73.39063999983597, 43.852993000127015),
        Point::new(-80.17018900002216, 26.119614000785646),
        Point::new(-88.88800800036876, 36.52252199989056),
        Point::new(-97.32386799960835, 32.74937400021008),
        Point::new(-117.92283599988133, 33.86894600035782),
        Point::new(-121.94641099986762, 37.37851000003661),
        Point::new(-81.16397899943115, 35.26835600002954),
        Point::new(-90.364104999446, 40.94405000000768),
        Point::new(-100.87279499968935, 37.964724999859015),
        Point::new(-118.25795700011531, 34.123637999494235),
        Point::new(-97.11043499927564, 47.918853999512635),
        Point::new(-83.24184399970068, 42.30490100038105),
        Point::new(-106.63481100002747, 48.19451500066691),
        Point::new(-108.56992300024609, 39.06481900019685),
        Point::new(-97.14026599987585, 33.62442399986787),
        Point::new(-87.99476600085012, 40.76207699985383),
        Point::new(-87.8053439998256, 42.074196000345296),
        Point::new(-108.7396769998935, 35.52924699994924),
        Point::new(-79.55370299999328, 43.18756499952525),
        Point::new(-79.5472790005253, 40.30485199942041),
        Point::new(-83.82668299992037, 34.28371799998587),
        Point::new(-113.2185589999977, 48.443966000031025),
        Point::new(-105.93483699992748, 40.08391600022338),
        Point::new(-110.164597000551, 38.99244300084399),
        Point::new(-79.8313520001945, 36.06120299951897),
        Point::new(-85.67899300022663, 42.956370999422234),
        Point::new(-82.41418500013748, 34.85656000004411),
        Point::new(-107.32267800028933, 39.548118999792166),
        Point::new(-119.84117099984161, 34.4375570004554),
        Point::new(-120.5729450005112, 34.96260499982105),
        Point::new(-89.09497800033432, 30.368607999859478),
        Point::new(-120.6281050000456, 35.12206600054566),
        Point::new(-90.1760860001686, 33.51773800020868),
        Point::new(-79.69845600054384, 34.88307200047262),
        Point::new(-76.87819699999142, 40.261561999586775),
        Point::new(-98.38732900043289, 40.584132999338635),
        Point::new(-109.67812300027612, 48.55441699974489),
        Point::new(-122.09778600002375, 37.66685899994303),
        Point::new(-90.39427900057524, 31.86289799974304),
        Point::new(-89.28618600008366, 31.32671900058159),
        Point::new(-91.43260199958246, 38.70729399921885),
        Point::new(-110.85257699972863, 39.688197999738065),
        Point::new(-72.6821209995843, 41.76779900002401),
        Point::new(-77.73355900004765, 39.32504299993468),
        Point::new(-78.0118330002926, 40.483494000647795),
        Point::new(-71.08594599930825, 42.77270799957466),
        Point::new(-80.88863400025878, 37.67707100052644),
        Point::new(-99.37074300068878, 40.43619200016087),
        Point::new(-90.46359299991684, 30.511697999263447),
        Point::new(-87.50874300068875, 41.69308099968856),
        Point::new(-87.66850999933683, 41.562351000098715),
        Point::new(-119.65077999999687, 36.32621400057582),
        Point::new(-80.16854100046663, 26.010687000304983),
        Point::new(-86.0977779996548, 42.78931400004126),
        Point::new(-95.36697400034967, 29.76718900037224),
        Point::new(-80.00583599943167, 35.957507999294876),
        Point::new(-73.7984389998598, 42.253082000234315),
        Point::new(-79.8290629998574, 33.66437899969122),
        Point::new(-90.40759300031658, 38.58088300005056),
        Point::new(-79.38522299974147, 40.31833999999117),
        Point::new(-86.89503499926565, 40.42108899975767),
        Point::new(-87.86971999987793, 41.815902999723846),
        Point::new(-103.54249599999025, 37.988067999838506),
        Point::new(-81.95161400048556, 28.045654000831632),
        Point::new(-92.48530599987185, 40.03140599968731),
        Point::new(-89.12783800032332, 31.692390000398348),
        Point::new(-118.23653399964422, 34.05629700030647),
        Point::new(-93.21499599976545, 30.23808499992299),
        Point::new(-89.36330399957978, 40.14753700053234),
        Point::new(-108.7063220004598, 32.35058999952901),
        Point::new(-82.65109999966512, 30.196611000197663),
        Point::new(-94.37764699990896, 38.91294499951226),
        Point::new(-77.5792160006178, 40.5885849995982),
        Point::new(-80.24999065834209, 35.821481764472026),
        Point::new(-92.01459499985918, 30.227345000171795),
        Point::new(-115.54862200040486, 48.39514899982663),
        Point::new(-81.95188386274992, 28.046777659661416),
        Point::new(-102.61829399996799, 38.08950000002517),
        Point::new(-105.88475799998156, 35.47748599977922),
        Point::new(-76.30758700033965, 40.05380599934756),
        Point::new(-96.71081500051173, 40.814671000666294),
        Point::new(-84.49354600014766, 42.71908199973467),
        Point::new(-121.27159399976313, 38.133539999371635),
        Point::new(-77.2213750003558, 38.70596299989268),
        Point::new(-83.30564900040088, 43.0496289994789),
        Point::new(-120.6025159999133, 34.68446000012909),
        Point::new(-95.23171999987795, 38.97221799986096),
        Point::new(-92.28637700019823, 34.7503509998989),
        Point::new(-91.24670483196229, 43.83321433987004),
        Point::new(-105.21214299979943, 35.59330000039489),
        Point::new(-76.16300999981149, 39.50946000037891),
        Point::new(-106.64698000002682, 35.082935000050384),
        Point::new(-121.81513200014155, 38.01808500002289),
        Point::new(-97.12541200016352, 34.171912999885194),
        Point::new(-82.63947300037853, 38.480929999719876),
        Point::new(-73.74125699971063, 42.641647000009186),
        Point::new(-81.09581000073081, 40.92178699947061),
        Point::new(-80.64464600011269, 37.72423900022983),
        Point::new(-84.75632499989865, 42.2473749996567),
        Point::new(-90.13494899979634, 38.90449099995982),
        Point::new(-103.66104100064149, 30.35715900068749),
        Point::new(-78.4009930005264, 40.51478200008938),
        Point::new(-77.06264500006654, 38.8062440000607),
        Point::new(-123.09964799935551, 44.63075600008949),
        Point::new(-72.51192500023842, 42.374858999743196),
        Point::new(-74.20952599952511, 42.94747899945645),
        Point::new(-117.88481900039642, 33.80425999949955),
        Point::new(-83.74402600039946, 42.28805199950034),
        Point::new(-75.28944400024028, 40.00726299968784),
        Point::new(-93.05244400039015, 34.11437600045224),
        Point::new(-121.08203099943091, 38.90418200009941),
        Point::new(-77.48167399995498, 37.75923499979558),
        Point::new(-84.39178500007756, 33.79956399967898),
        Point::new(-85.83188599933925, 33.648997999957885),
        Point::new(-87.48733500001009, 31.0243280006369),
        Point::new(-97.75556900020905, 30.26909299994213),
        Point::new(-76.61747700076285, 39.3081210001842),
        Point::new(-86.11187000020021, 42.31418600048369),
        Point::new(-117.02535199989472, 34.90479999972035),
        Point::new(-89.33733399986403, 30.306900000534768),
        Point::new(-71.0763549994835, 42.347304999826065),
        Point::new(-122.50988800063055, 48.72048600032883),
        Point::new(-110.29398300021512, 31.968167999753575),
        Point::new(-72.7657239995628, 41.63552500027873),
        Point::new(-119.02246100017487, 35.37138000078659),
        Point::new(-78.87506100066452, 42.878483000390304),
        Point::new(-86.80702999953468, 33.51239400018312),
        Point::new(-88.89114400019531, 30.39912000038788),
        Point::new(-122.29999499986923, 37.867603000578185),
        Point::new(-72.44544999961761, 43.135826000369775),
        Point::new(-83.19529699985651, 42.54572300021647),
        Point::new(-94.1229629993428, 30.07690600001206),
        Point::new(-79.43628700014477, 36.09417700026853),
        Point::new(-121.46909300004177, 45.71538499951828),
        Point::new(-88.98403899969992, 40.508347000114156),
        Point::new(-71.06214499979177, 42.365389000102425),
        Point::new(-71.05529799970276, 42.351524000132656),
        Point::new(-72.55035399983706, 42.83869600022041),
        Point::new(-90.44212299997633, 31.578757999682125),
        Point::new(-91.10198200006909, 40.805943000169464),
        Point::new(-113.01084100061155, 48.53329500056401),
        Point::new(-73.18740100015589, 41.17674600012799),
        Point::new(-85.18569199988576, 42.31697500049603),
        Point::new(-78.7266080003588, 42.90691799956619),
        Point::new(-118.35591099999249, 34.19383199984708),
        Point::new(-76.69339799991764, 39.18955199932549),
        Point::new(-84.55275000001234, 41.480347000114136),
        Point::new(-80.62615999928437, 34.24734900005649),
        Point::new(-97.38166000000882, 32.348334999860526),
        Point::new(-89.0124819992447, 43.3406679993289),
        Point::new(-89.2163700000753, 37.7240870004149),
        Point::new(-89.13619199976085, 38.52777099963208),
        Point::new(-87.63916799970326, 41.87873100033556),
        Point::new(-88.24092899967343, 40.11619599954594),
        Point::new(-79.99890099978114, 32.87553399949462),
        Point::new(-81.64672099937445, 38.35198999993872),
        Point::new(-121.84471899938217, 39.72330900011042),
        Point::new(-84.53652999935986, 39.102379000190865),
        Point::new(-85.53761300053941, 30.780727000350964),
        Point::new(-72.37930299973351, 43.36878600007401),
        Point::new(-81.04057300034356, 33.99371699944015),
        Point::new(-81.69817399973016, 41.50441699944514),
        Point::new(-79.83649399989804, 37.811770999732005),
        Point::new(-77.99304199978832, 38.47292300009656),
        Point::new(-80.82363899954004, 35.241145999788216),
        Point::new(-119.0331120003184, 34.21646900054412),
        Point::new(-121.78066300059686, 43.21690399991985),
        Point::new(-94.72526600002573, 32.49587200019283),
        Point::new(-79.1574629997175, 37.40702399925834),
        Point::new(-90.6722789998758, 40.461132000041914),
        Point::new(-107.87244400009041, 48.3598819994549),
        Point::new(-88.37552600042443, 39.482421999975486),
        Point::new(-83.77107200027245, 38.65162300040129),
        Point::new(-90.45294200067264, 31.249292000325738),
        Point::new(-120.47589099986959, 37.3070409993428),
        Point::new(-97.4017259999548, 31.43792199990054),
        Point::new(-86.90521999950323, 41.721358999718234),
        Point::new(-100.62534300077874, 40.19756300073209),
        Point::new(-72.80121600041792, 41.538998000557456),
        Point::new(-83.41333800044822, 30.459109999626946),
        Point::new(-120.01894399966568, 36.974517999306386),
        Point::new(-89.11728699939533, 41.55004099989242),
        Point::new(-88.69616700020674, 32.36382300003157),
        Point::new(-90.0588759999273, 35.13243100009072),
        Point::new(-74.32785800024635, 40.56775300030091),
        Point::new(-94.3668439999505, 32.551350000002685),
        Point::new(-80.25807200042232, 25.84984799988547),
        Point::new(-76.73161299954012, 40.19294700010414),
        Point::new(-95.49013499983022, 32.661879999762334),
        Point::new(-76.50291400028073, 40.10891699932023),
        Point::new(-87.92447571638104, 42.94174653547441),
        Point::new(-87.91648099969825, 43.034016000738006),
        Point::new(-81.32407399971515, 38.1807019996977),
        Point::new(-120.91159799994762, 37.668139999661435),
        Point::new(-88.03810100006098, 30.69045100021367),
        Point::new(-101.29790500031538, 48.23573300027789),
        Point::new(-118.87695299988087, 34.285193999703495),
        Point::new(-72.60868100062754, 44.25736199935693),
        Point::new(-77.96150200041683, 39.45827100050644),
        Point::new(-112.04792800057663, 33.05843700026753),
        Point::new(-93.18632500049824, 44.96332900063305),
        Point::new(-77.47384600049236, 38.750034000668734),
        Point::new(-91.55123899997972, 40.971305999672325),
        Point::new(-73.66523700048702, 45.45421599936907),
        Point::new(-122.13635299969104, 38.01973300047774),
        Point::new(-92.81235500018295, 34.36591699996973),
        Point::new(-122.32978099929352, 48.435589000432174),
        Point::new(-71.95978499977775, 41.349201000226174),
        Point::new(-74.44850200056675, 40.49535399988736),
        Point::new(-86.73987599997724, 41.78794900024633),
        Point::new(-89.26296200019601, 36.11244999936815),
        Point::new(-76.86443299928334, 38.95333099942627),
        Point::new(-114.60487400013483, 34.84027900017588),
        Point::new(-97.34460400077387, 38.04730999965693),
        Point::new(-79.03066299969754, 43.11360199983261),
        Point::new(-79.0780410000919, 43.12139500037915),
        Point::new(-118.52675230967122, 34.37898495419245),
        Point::new(-72.9259949998692, 41.29866800002833),
        Point::new(-91.82351699980956, 30.00848799972158),
        Point::new(-72.09388699928542, 41.35433200032173),
        Point::new(-86.25361600057784, 41.836575000635946),
        Point::new(-90.0795969995018, 29.946796000235395),
        Point::new(-97.4421690006987, 35.21962700028598),
        Point::new(-76.45104999985745, 37.019355999479956),
        Point::new(-88.14504999925794, 41.77950700034796),
        Point::new(-75.75334899935666, 39.670321999161104),
        Point::new(-73.78200500013048, 40.9139210000543),
        Point::new(-78.70593366390733, 35.794048809704975),
        Point::new(-74.16488599948912, 40.73427999952253),
        Point::new(-73.99186700036165, 40.74968000013206),
        Point::new(-122.19774049682633, 37.75188125691466),
        Point::new(-97.51263400005888, 35.46614500019177),
        Point::new(-80.83030699946829, 27.25121900005695),
        Point::new(-122.27074399993552, 37.79464699965945),
        Point::new(-79.6737059995321, 43.452601999982505),
        Point::new(-117.19998812575125, 32.75545496227687),
        Point::new(-122.79580699999292, 46.99066200075089),
        Point::new(-95.92742199992523, 41.25016800005335),
        Point::new(-117.64785799964682, 34.06170699977838),
        Point::new(-70.37484799973527, 43.51578400073123),
        Point::new(-122.5964080002289, 45.36543099964109),
        Point::new(-81.38174399988554, 28.525694000278065),
        Point::new(-72.37602200041482, 41.30053300059768),
        Point::new(-93.76574700002391, 41.03744500008685),
        Point::new(-117.37862399989751, 33.19258099991339),
        Point::new(-92.41567200016254, 41.01964199927903),
        Point::new(-119.17486600016565, 34.19883300024293),
        Point::new(-88.55857100055107, 30.367173999380725),
        Point::new(-81.64054099946742, 29.64930899981067),
        Point::new(-75.48374899981633, 40.04228600049868),
        Point::new(-75.92177599986235, 39.95918299929616),
        Point::new(-90.39343300023262, 36.753985999854194),
        Point::new(-89.46167799993958, 41.38690599971227),
        Point::new(-122.67502599965002, 45.528682999820774),
        Point::new(-79.99325600026407, 40.44504199998846),
        Point::new(-75.18318899977237, 39.954609000605046),
        Point::new(-75.15436599979091, 39.99690600051167),
        Point::new(-89.6801380000685, 30.524711999559315),
        Point::new(-73.25604199993819, 42.4504010003061),
        Point::new(-74.62323000026413, 40.317218999557326),
        Point::new(-73.44745599929479, 44.69699099953516),
        Point::new(-88.53835837154145, 41.66199036276521),
        Point::new(-87.20449100035921, 30.417933000108007),
        Point::new(-83.29201411805695, 42.63372020552322),
        Point::new(-89.46913900046434, 43.546611999644256),
        Point::new(-73.46192900032298, 44.033065999896166),
        Point::new(-88.63649699953675, 40.87943999995622),
        Point::new(-70.29049300015168, 43.65201300029992),
        Point::new(-117.75063299971299, 34.05939500017928),
        Point::new(-73.93901100005746, 41.70567299940956),
        Point::new(-120.68693499975029, 35.6229249995892),
        Point::new(-81.05422200024498, 37.8587070004279),
        Point::new(-73.44427500009101, 44.57804099999231),
        Point::new(-111.66272000002783, 40.22586800020821),
        Point::new(-119.08424400026024, 46.23359699930222),
        Point::new(-116.54501299925039, 33.89594299976977),
        Point::new(-77.4289700003651, 37.24161900051661),
        Point::new(-82.44181100067698, 42.96078899991261),
        Point::new(-97.35633899964495, 35.01197400030003),
        Point::new(-71.4159929993773, 41.825630000424326),
        Point::new(-97.21900200024197, 34.74146700030201),
        Point::new(-77.29304500042628, 38.52201100020767),
        Point::new(-91.36634800015992, 39.95744299999461),
        Point::new(-104.43752300088562, 36.90074900046619),
        Point::new(-122.3919219997004, 40.58283200049658),
        Point::new(-92.54183999981598, 44.56454099976747),
        Point::new(-87.15447999995189, 40.943039000149895),
        Point::new(-78.64448499938305, 35.773749999562995),
        Point::new(-73.9520719998228, 41.920891000219626),
        Point::new(-122.35305000035709, 37.93608499932344),
        Point::new(-117.36962100020884, 33.976521000543926),
        Point::new(-77.14667017688703, 39.084517624389036),
        Point::new(-121.23627499969132, 38.79154600034781),
        Point::new(-77.79789700014629, 35.93815199971516),
        Point::new(-119.81123400064848, 39.528640999982315),
        Point::new(-77.60952800001701, 43.16260499962118),
        Point::new(-75.45143900000971, 43.19922599948046),
        Point::new(-83.1478419995085, 42.489043999880835),
        Point::new(-72.66584800008496, 43.92285499955875),
        Point::new(-73.37109400048757, 44.99480099956662),
        Point::new(-121.28446199962144, 38.750565000874246),
        Point::new(-71.14993999973103, 42.20787400008521),
        Point::new(-88.15972832090512, 40.31051202481024),
        Point::new(-72.98224600025253, 43.60725800035658),
        Point::new(-99.99762699998593, 48.36928599964932),
        Point::new(-77.42979000040805, 37.53406000026894),
        Point::new(-77.49658199945958, 37.61425000023746),
        Point::new(-73.08641100056707, 44.81095100008878),
        Point::new(-121.4995500007318, 38.58403000038436),
        Point::new(-80.45742000053247, 35.6734199998333),
        Point::new(-117.16856399952883, 32.71616400026858),
        Point::new(-70.44761200079307, 43.49630399992981),
        Point::new(-73.81015799979173, 43.08211500020724),
        Point::new(-98.47813399978412, 29.419104000349478),
        Point::new(-81.14415699994544, 32.07850599965235),
        Point::new(-119.69072000002785, 34.413924999739095),
        Point::new(-81.43474600062729, 27.49725700031047),
        Point::new(-111.85322600067923, 48.505313999841405),
        Point::new(-79.23625900015259, 43.156555000313176),
        Point::new(-94.14778900026198, 45.56689100001978),
        Point::new(-90.81265299993584, 29.746907999504742),
        Point::new(-89.78243299958314, 30.27823299965337),
        Point::new(-73.94282499967386, 42.81526599982618),
        Point::new(-122.32842999994438, 47.598911000442456),
        Point::new(-93.2283779999446, 38.71187199989305),
        Point::new(-81.28858200065866, 28.807592000370676),
        Point::new(-118.69371799998555, 34.26994699985431),
        Point::new(-121.90120699990297, 37.33107000038041),
        Point::new(-86.48674800011997, 42.1066169998748),
        Point::new(-121.28427099980667, 37.94601100020765),
        Point::new(-121.27898899994227, 37.95666799972855),
        Point::new(-82.71861008398804, 41.44075239190954),
        Point::new(-111.90238200032888, 40.762015999738765),
        Point::new(-123.02623699993745, 44.9321709999918),
        Point::new(-120.65394600010768, 35.27741600054816),
        Point::new(-73.4879459995081, 45.50278099964356),
        Point::new(-97.93567699979354, 29.879232000656486),
        Point::new(-87.81317899961101, 41.79216399946915),
        Point::new(-117.85504199958848, 33.75316599951145),
        Point::new(-117.3069310005651, 34.10436200000646),
        Point::new(-117.66326099949538, 33.5014839997869),
        Point::new(-102.39905499988816, 30.140098999469387),
        Point::new(-117.61901100035726, 33.41915900028778),
        Point::new(-121.65618899992228, 36.679362999403054),
        Point::new(-86.28914600048739, 41.67900800001934),
        Point::new(-117.27007299966903, 32.99205400029206),
        Point::new(-79.39189900003868, 35.17409900066849),
        Point::new(-81.93573799950894, 34.953769999785834),
        Point::new(-72.59358999987842, 42.10596100020018),
        Point::new(-89.65167199946308, 39.801585999994074),
        Point::new(-117.4130629998574, 47.656986000403776),
        Point::new(-94.79511300056436, 46.35458800033609),
        Point::new(-82.9642870001448, 38.72091299953547),
        Point::new(-119.75541800054015, 39.53364899980164),
        Point::new(-116.60822300039104, 48.25175899917866),
        Point::new(-78.28144100020182, 35.532203999615035),
        Point::new(-79.07272300036601, 38.147780999593635),
        Point::new(-90.20545200000964, 38.62394700025402),
        Point::new(-73.54267900003566, 41.04618100005325),
        Point::new(-102.39077800040423, 48.31936299970283),
        Point::new(-122.03954299950965, 38.243465000009905),
        Point::new(-87.90560195846348, 42.7187940233257),
        Point::new(-76.15216799985313, 43.086372000467634),
        Point::new(-122.4184720000826, 47.24182899920913),
        Point::new(-97.40879799962784, 30.567435999372037),
        Point::new(-83.33136700018673, 34.57853300039784),
        Point::new(-87.56015000072182, 33.1922570002605),
        Point::new(-81.07805600038398, 37.9566649995902),
        Point::new(-84.28953599998624, 30.43301599958886),
        Point::new(-90.5041660003605, 43.98572500030866),
        Point::new(-83.54126700037159, 41.63818400059131),
        Point::new(-95.66489399915861, 39.051345999418515),
        Point::new(-82.45091200038837, 27.952264999230522),
        Point::new(-97.34480300005828, 31.095379000040964),
        Point::new(-74.75456199973632, 40.21824999963792),
        Point::new(-104.50727099955685, 37.172801999812634),
        Point::new(-120.79879799982768, 37.53031200009889),
        Point::new(-120.18257100005144, 39.327915000177256),
        Point::new(-122.24258061580264, 47.46112072474182),
        Point::new(-110.96593499950046, 32.223061000065286),
        Point::new(-79.42417899936117, 43.64655699960599),
        Point::new(-94.04244200029791, 33.420074000215095),
        Point::new(-78.24105100010343, 40.67032199986056),
        Point::new(-75.22393799933906, 43.10407300016897),
        Point::new(-123.01734900015606, 49.22974800017022),
        Point::new(-122.68472299986638, 45.62980300000862),
        Point::new(-119.29657699932892, 34.27675199980513),
        Point::new(-118.44792200010005, 34.210979000080954),
        Point::new(-117.29212999969957, 34.53662899972875),
        Point::new(-72.75247199998267, 44.3350720000729),
        Point::new(-119.33135200039436, 35.59427300029887),
        Point::new(-91.01222200034488, 38.561374999756595),
        Point::new(-93.74045599924483, 38.76317199948835),
        Point::new(-77.00637099952183, 38.897304999526284),
        Point::new(-76.70805400039166, 37.27572599955539),
        Point::new(-77.24827599983735, 38.657443999940824),
        Point::new(-89.77507800034931, 43.62478599927459),
        Point::new(-70.6096309998706, 43.32182600007002),
        Point::new(-120.30584000001585, 47.421623000501256),
        Point::new(-72.82535599937972, 41.45706899953484),
        Point::new(-114.33515899978784, 48.41357000035538),
        Point::new(-113.97164200037787, 48.498733999474666),
        Point::new(-73.40310700008786, 43.55496599998111),
        Point::new(-120.96631600068275, 45.657309999557015),
        Point::new(-75.55217700056795, 39.736915999873645),
        Point::new(-91.64174700002388, 44.04493700054229),
        Point::new(-105.8173680003328, 39.94869600042023),
        Point::new(-77.90829500011404, 35.723067999688624),
        Point::new(-110.69308500027239, 35.02090800040406),
        Point::new(-71.83068799995107, 41.38101599968883),
        Point::new(-112.1886670003816, 35.25239199949135),
        Point::new(-72.64376100046962, 41.85191699947012),
        Point::new(-72.62588666273916, 41.9135529568037),
        Point::new(-72.38545200000965, 43.48044199959878),
        Point::new(-117.73156700001687, 40.969542999310136),
        Point::new(-90.95616099973023, 36.06831700022957),
        Point::new(-71.14011580569974, 42.51397241469533),
        Point::new(-71.79332700014078, 42.261379000640545),
        Point::new(-80.06246200002113, 26.712340999637604),
        Point::new(-81.35198199976935, 28.597131999542285),
        Point::new(-105.64035800062106, 48.09078200048907),
        Point::new(-72.31795499992313, 43.6485560000595),
        Point::new(-73.45289600015013, 44.18709600018042),
        Point::new(-80.30580900028497, 37.785419000386696),
        Point::new(-81.73426099924558, 28.002250999384273),
        Point::new(-85.02519199981077, 41.431704999885994),
        Point::new(-103.6203769995987, 48.142765000104816),
        Point::new(-90.41503899925027, 32.84808299983075),
        Point::new(-80.8471449998417, 32.688144999592225),
        Point::new(-73.9028850005422, 40.936096000130476),
        Point::new(-114.61513499938059, 32.722023000661125),
        Point::new(-121.65071611085966, 37.12920777731722),
        Point::new(-79.85723999882674, 43.31052507966888),
    ];

    let mp = MultiPoint::from(points.clone());
    let res = mp.convex_hull();

    use crate::Contains;

    let mut uncontained = vec![];

    for point in &points {
        if !res.contains(point) {
            uncontained.push(*point);
        }
    }

    assert_eq!(uncontained, Vec::<Point>::new());
}
